// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum FoodCategory {
  ENERGY_GEL
  ENERGY_BAR
  SPORTS_DRINK
  FRUIT
  SNACK
  OTHER
}

model User {
  id         String   @id @default(uuid())
  auth0_sub  String   @unique
  email      String?
  first_name String
  last_name  String
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt
  foodItems  FoodItem[]
  events     Event[]
}

model FoodItem {
  id                String             @id @default(uuid())
  item_name         String
  brand             String?
  category          FoodCategory?
  created_by        String
  created_at        DateTime           @default(now())
  updated_at        DateTime           @updatedAt
  user              User               @relation(fields: [created_by], references: [id])
  foodInstances     FoodInstance[]
  foodItemNutrients FoodItemNutrient[]
}

model Event {
  id                String         @id @default(uuid())
  event_user_id     String
  created_at        DateTime       @default(now())
  updated_at        DateTime       @updatedAt
  expected_duration Int
  type              String
  user              User           @relation(fields: [event_user_id], references: [id])
  foodInstances     FoodInstance[]
}

model FoodInstance {
  id                         String   @id @default(uuid())
  time_elapsed_at_consumption Int
  created_at                 DateTime @default(now())
  updated_at                 DateTime @updatedAt
  food_item_id               String
  servings                   Int
  event_id                   String
  foodItem                   FoodItem @relation(fields: [food_item_id], references: [id])
  event                      Event    @relation(fields: [event_id], references: [id])
}

model Nutrient {
  id                   String             @id @default(uuid())
  created_at           DateTime           @default(now())
  updated_at           DateTime           @updatedAt
  nutrient_name        String
  nutrient_abbreviation String
  foodItemNutrients    FoodItemNutrient[]
}

model FoodItemNutrient {
  id           String   @id @default(uuid())
  food_item_id String
  nutrient_id  String
  quantity     Float
  unit         String
  foodItem     FoodItem @relation(fields: [food_item_id], references: [id])
  nutrient     Nutrient @relation(fields: [nutrient_id], references: [id])
}
